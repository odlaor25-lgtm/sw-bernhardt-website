<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SW.BERNHARDT - Legal Assistant Platform</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: #000;
            color: #00ff41;
            font-family: 'Courier New', monospace;
            overflow-x: hidden;
            min-height: 100vh;
        }

        /* Matrix Rain Effect */
        #matrix-canvas {
            position: fixed;
            top: 0;
            left: 0;
            z-index: 1;
            pointer-events: none;
        }

        /* Scanner Effect */
        .scanner {
            position: fixed;
            top: 0;
            left: -150px;
            width: 150px;
            height: 100vh;
            background: linear-gradient(90deg, 
                transparent 0%, 
                rgba(0, 255, 65, 0.1) 10%, 
                rgba(0, 255, 65, 0.3) 30%, 
                rgba(0, 255, 65, 0.5) 50%, 
                rgba(0, 255, 65, 0.3) 70%, 
                rgba(0, 255, 65, 0.1) 90%, 
                transparent 100%);
            z-index: 2;
            animation: scan 8s linear infinite;
            box-shadow: 0 0 50px rgba(0, 255, 65, 0.3);
            pointer-events: none;
        }

        @keyframes scan {
            0% { left: -150px; }
            100% { left: calc(100vw + 50px); }
        }

        /* Grid Pattern */
        .grid-pattern {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                linear-gradient(rgba(0, 255, 65, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 255, 65, 0.03) 1px, transparent 1px);
            background-size: 50px 50px;
            z-index: 0;
            pointer-events: none;
            animation: gridMove 20s linear infinite;
        }

        @keyframes gridMove {
            0% { transform: translate(0, 0); }
            100% { transform: translate(50px, 50px); }
        }

        /* Navigation */
        .main-nav {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid #00ff41;
            z-index: 100;
            padding: 15px 20px;
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: bold;
            color: #00ff41;
            text-shadow: 0 0 10px #00ff41;
            cursor: pointer;
        }

        .nav-menu {
            display: flex;
            gap: 30px;
        }

        .nav-item {
            cursor: pointer;
            padding: 8px 16px;
            border: 1px solid transparent;
            border-radius: 4px;
            transition: all 0.3s ease;
        }

        .nav-item:hover, .nav-item.active {
            border-color: #00ff41;
            background: rgba(0, 255, 65, 0.1);
            box-shadow: 0 0 10px rgba(0, 255, 65, 0.3);
        }

        /* Content */
        .content {
            position: relative;
            z-index: 10;
            padding: 100px 20px 50px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .page {
            display: none;
        }

        .page.active {
            display: block;
        }

        /* Home Page */
        .hero-section {
            text-align: center;
            padding: 50px 0;
            margin-bottom: 50px;
        }

        .hero-title {
            font-size: 3rem;
            color: #00ff41;
            text-shadow: 0 0 20px #00ff41;
            margin-bottom: 20px;
        }

        .hero-subtitle {
            font-size: 1.5rem;
            opacity: 0.8;
            margin-bottom: 30px;
        }

        .hero-description {
            font-size: 1.1rem;
            line-height: 1.6;
            max-width: 800px;
            margin: 0 auto 40px;
            opacity: 0.9;
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-bottom: 50px;
        }

        .feature-card {
            background: rgba(0, 255, 65, 0.05);
            border: 1px solid #00ff41;
            border-radius: 12px;
            padding: 30px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .feature-card:hover {
            background: rgba(0, 255, 65, 0.1);
            box-shadow: 0 0 20px rgba(0, 255, 65, 0.3);
            transform: translateY(-5px);
        }

        .feature-icon {
            font-size: 3rem;
            margin-bottom: 20px;
            color: #00ff41;
            text-shadow: 0 0 10px #00ff41;
        }

        .feature-title {
            font-size: 1.3rem;
            color: #00ff41;
            margin-bottom: 15px;
        }

        .feature-description {
            opacity: 0.8;
            line-height: 1.5;
        }

        /* Calculator Styles */
        .calculator-container {
            background: rgba(0, 255, 65, 0.05);
            border: 1px solid #00ff41;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 30px;
            backdrop-filter: blur(5px);
        }

        .calculator-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .calculator-title {
            font-size: 2.5rem;
            color: #00ff41;
            text-shadow: 0 0 20px #00ff41;
            margin-bottom: 10px;
        }

        .calculator-subtitle {
            font-size: 1.2rem;
            opacity: 0.8;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-label {
            display: block;
            margin-bottom: 8px;
            color: #00ff41;
            font-weight: bold;
        }

        .input-field {
            width: 100%;
            padding: 15px;
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid #00ff41;
            border-radius: 6px;
            color: #00ff41;
            font-family: 'Courier New', monospace;
            font-size: 1rem;
        }

        .input-field:focus {
            outline: none;
            box-shadow: 0 0 10px rgba(0, 255, 65, 0.5);
            border-color: #00cc33;
        }

        .input-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .results-section {
            background: rgba(0, 255, 65, 0.05);
            border: 2px solid #00ff41;
            border-radius: 12px;
            padding: 25px;
            margin-top: 30px;
            display: none;
        }

        .results-title {
            font-size: 1.5rem;
            color: #00ff41;
            text-shadow: 0 0 10px #00ff41;
            margin-bottom: 20px;
            text-align: center;
        }

        .result-item {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid rgba(0, 255, 65, 0.2);
        }

        .result-item:last-child {
            border-bottom: none;
        }

        .result-label {
            font-weight: bold;
            color: #00ff41;
        }

        .result-value {
            color: #ffffff;
            font-weight: bold;
        }

        .result-value.highlight {
            color: #ffff00;
            text-shadow: 0 0 5px #ffff00;
        }

        .result-value.danger {
            color: #ff0000;
            text-shadow: 0 0 5px #ff0000;
        }

        /* Scanner Styles */
        .scanner-container {
            background: rgba(0, 255, 65, 0.05);
            border: 1px solid #00ff41;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 30px;
            backdrop-filter: blur(5px);
        }

        .scanner-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .scanner-title {
            font-size: 2.5rem;
            color: #00ff41;
            text-shadow: 0 0 20px #00ff41;
            margin-bottom: 10px;
        }

        .scanner-subtitle {
            font-size: 1.2rem;
            opacity: 0.8;
        }

        /* Upload Section */
        .upload-section {
            background: rgba(0, 255, 65, 0.03);
            border: 2px dashed #00ff41;
            border-radius: 12px;
            padding: 40px;
            text-align: center;
            margin-bottom: 30px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .upload-section:hover {
            background: rgba(0, 255, 65, 0.1);
            border-color: #00cc33;
            box-shadow: 0 0 20px rgba(0, 255, 65, 0.3);
        }

        .upload-section.dragover {
            background: rgba(0, 255, 65, 0.2);
            border-color: #00ff41;
            box-shadow: 0 0 30px rgba(0, 255, 65, 0.5);
        }

        .upload-icon {
            font-size: 4rem;
            margin-bottom: 20px;
            color: #00ff41;
            text-shadow: 0 0 10px #00ff41;
        }

        .upload-text {
            font-size: 1.3rem;
            margin-bottom: 15px;
            color: #00ff41;
        }

        .upload-subtext {
            opacity: 0.7;
            margin-bottom: 20px;
        }

        .file-input {
            display: none;
        }

        .upload-btn {
            background: rgba(0, 255, 65, 0.2);
            color: #00ff41;
            padding: 15px 30px;
            border: 1px solid #00ff41;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-weight: bold;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
        }

        .upload-btn:hover {
            background: rgba(0, 255, 65, 0.3);
            box-shadow: 0 0 20px rgba(0, 255, 65, 0.5);
            transform: translateY(-2px);
        }

        /* File Preview */
        .file-preview {
            background: rgba(0, 255, 65, 0.05);
            border: 1px solid #00ff41;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            display: none;
        }

        .file-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .file-name {
            font-weight: bold;
            color: #00ff41;
        }

        .file-size {
            opacity: 0.7;
        }

        .preview-image {
            max-width: 100%;
            max-height: 300px;
            border: 1px solid #00ff41;
            border-radius: 4px;
            margin-bottom: 15px;
        }

        /* Analysis Section */
        .analysis-section {
            background: rgba(0, 255, 65, 0.05);
            border: 2px solid #00ff41;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
            display: none;
        }

        .analysis-title {
            font-size: 1.5rem;
            color: #00ff41;
            text-shadow: 0 0 10px #00ff41;
            margin-bottom: 20px;
            text-align: center;
        }

        .scanning-animation {
            text-align: center;
            padding: 40px;
        }

        .scanning-text {
            font-size: 1.2rem;
            color: #00ff41;
            margin-bottom: 20px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid #00ff41;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 20px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #00ff41, #00cc33);
            width: 0%;
            transition: width 0.3s ease;
            box-shadow: 0 0 10px rgba(0, 255, 65, 0.5);
        }

        /* Results */
        .results-container {
            display: none;
        }

        .contract-summary {
            background: rgba(0, 255, 65, 0.05);
            border: 1px solid #00ff41;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .summary-title {
            font-size: 1.3rem;
            color: #00ff41;
            margin-bottom: 15px;
            text-shadow: 0 0 5px #00ff41;
        }

        .summary-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid rgba(0, 255, 65, 0.2);
        }

        .summary-item:last-child {
            border-bottom: none;
        }

        .summary-label {
            font-weight: bold;
            color: #00ff41;
        }

        .summary-value {
            color: #ffffff;
        }

        /* Legal Issues */
        .legal-issues {
            margin-bottom: 20px;
        }

        .issue-card {
            background: rgba(255, 0, 0, 0.1);
            border: 2px solid #ff0000;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 15px;
            animation: warningPulse 2s infinite;
        }

        .issue-card.warning {
            background: rgba(255, 255, 0, 0.1);
            border-color: #ffff00;
            animation: none;
        }

        .issue-card.info {
            background: rgba(0, 150, 255, 0.1);
            border-color: #0096ff;
            animation: none;
        }

        @keyframes warningPulse {
            0%, 100% { 
                box-shadow: 0 0 10px rgba(255, 0, 0, 0.3);
                border-color: #ff0000;
            }
            50% { 
                box-shadow: 0 0 25px rgba(255, 0, 0, 0.7);
                border-color: #ff4444;
            }
        }

        .issue-header {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .issue-icon {
            font-size: 1.5rem;
            margin-right: 10px;
        }

        .issue-title {
            font-size: 1.2rem;
            font-weight: bold;
        }

        .issue-severity {
            margin-left: auto;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .severity-critical {
            background: rgba(255, 0, 0, 0.3);
            color: #ff0000;
            border: 1px solid #ff0000;
        }

        .severity-warning {
            background: rgba(255, 255, 0, 0.3);
            color: #ffff00;
            border: 1px solid #ffff00;
        }

        .severity-info {
            background: rgba(0, 150, 255, 0.3);
            color: #0096ff;
            border: 1px solid #0096ff;
        }

        .issue-description {
            margin-bottom: 15px;
            line-height: 1.5;
        }

        .legal-reference {
            background: rgba(0, 0, 0, 0.3);
            border-left: 4px solid #00ff41;
            padding: 10px 15px;
            margin: 10px 0;
            font-size: 0.9rem;
        }

        .legal-link {
            color: #00ff41;
            text-decoration: underline;
            cursor: pointer;
        }

        .legal-link:hover {
            color: #00cc33;
            text-shadow: 0 0 5px #00ff41;
        }

        .penalty-info {
            background: rgba(255, 0, 0, 0.1);
            border: 1px solid #ff0000;
            border-radius: 4px;
            padding: 10px;
            margin-top: 10px;
        }

        .penalty-title {
            font-weight: bold;
            color: #ff0000;
            margin-bottom: 5px;
        }

        /* Buttons */
        .action-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin: 30px 0;
            flex-wrap: wrap;
        }

        .btn {
            background: rgba(0, 255, 65, 0.2);
            color: #00ff41;
            padding: 15px 30px;
            border: 1px solid #00ff41;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-weight: bold;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
        }

        .btn:hover {
            background: rgba(0, 255, 65, 0.3);
            box-shadow: 0 0 20px rgba(0, 255, 65, 0.5);
            transform: translateY(-2px);
        }

        .btn-primary {
            background: #00ff41;
            color: #000;
        }

        .btn-primary:hover {
            background: #00cc33;
            box-shadow: 0 0 25px rgba(0, 255, 65, 0.7);
        }

        .btn-danger {
            background: rgba(255, 0, 0, 0.2);
            color: #ff0000;
            border-color: #ff0000;
        }

        .btn-danger:hover {
            background: rgba(255, 0, 0, 0.3);
            box-shadow: 0 0 20px rgba(255, 0, 0, 0.5);
        }

        /* Legal Database */
        .legal-database {
            background: rgba(0, 255, 65, 0.05);
            border: 1px solid #00ff41;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 30px;
        }

        .database-title {
            font-size: 2rem;
            color: #00ff41;
            text-shadow: 0 0 15px #00ff41;
            margin-bottom: 20px;
            text-align: center;
        }

        .law-category {
            background: rgba(0, 255, 65, 0.03);
            border: 1px solid rgba(0, 255, 65, 0.3);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .category-title {
            font-size: 1.3rem;
            color: #00ff41;
            margin-bottom: 15px;
            font-weight: bold;
        }

        .law-item {
            padding: 10px 0;
            border-bottom: 1px solid rgba(0, 255, 65, 0.1);
        }

        .law-item:last-child {
            border-bottom: none;
        }

        .law-title {
            font-weight: bold;
            color: #ffffff;
            margin-bottom: 5px;
        }

        .law-description {
            opacity: 0.8;
            margin-bottom: 5px;
        }

        .law-source {
            font-size: 0.9rem;
            color: #00ff41;
        }

        /* Footer */
        .footer {
            background: rgba(0, 255, 65, 0.05);
            border-top: 1px solid #00ff41;
            padding: 30px 20px;
            margin-top: 50px;
            text-align: center;
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
        }

        .footer-title {
            font-size: 1.5rem;
            color: #00ff41;
            margin-bottom: 15px;
        }

        .footer-text {
            opacity: 0.8;
            line-height: 1.6;
            margin-bottom: 20px;
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 30px;
            flex-wrap: wrap;
        }

        .footer-link {
            color: #00ff41;
            text-decoration: underline;
            cursor: pointer;
        }

        .footer-link:hover {
            color: #00cc33;
            text-shadow: 0 0 5px #00ff41;
        }

        /* Notification */
        .notification {
            position: fixed;
            top: 80px;
            right: 20px;
            background: rgba(0, 255, 65, 0.9);
            color: #000;
            padding: 15px 20px;
            border-radius: 4px;
            font-weight: bold;
            z-index: 1001;
            transform: translateX(400px);
            transition: transform 0.3s ease;
            font-family: 'Courier New', monospace;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.error {
            background: rgba(255, 0, 0, 0.9);
            color: #fff;
        }

        /* Controls */
        .controls {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: 8px;
            align-items: flex-end;
        }

        .control-btn {
            background: rgba(0, 255, 65, 0.1);
            border: 1px solid #00ff41;
            color: #00ff41;
            padding: 8px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-family: 'Courier New', monospace;
            font-size: 11px;
            transition: all 0.3s ease;
            backdrop-filter: blur(5px);
        }

        .control-btn:hover {
            background: rgba(0, 255, 65, 0.2);
            box-shadow: 0 0 10px rgba(0, 255, 65, 0.5);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .nav-menu {
                display: none;
            }
            
            .content {
                padding: 80px 15px 30px;
            }
            
            .action-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .hero-title {
                font-size: 2rem;
            }
            
            .input-row {
                grid-template-columns: 1fr;
            }
            
            .footer-links {
                flex-direction: column;
                gap: 15px;
            }
        }
    </style>
</head>
<body>
    <!-- Background Effects -->
    <div class="grid-pattern"></div>
    <canvas id="matrix-canvas"></canvas>
    <div class="scanner"></div>

    <!-- Controls -->
    <div class="controls">
        <button class="control-btn" onclick="toggleMatrix()" id="matrixBtn">⏸️ Matrix</button>
        <button class="control-btn" onclick="toggleScanner()" id="scannerBtn">📡 Scan</button>
        <button class="control-btn" onclick="changeSpeed()" id="speedBtn">⚡ 1x</button>
    </div>

    <!-- Navigation -->
    <nav class="main-nav">
        <div class="nav-container">
            <div class="logo" onclick="showPage('home')">⚖️ SW.BERNHARDT</div>
            <div class="nav-menu">
                <div class="nav-item active" onclick="showPage('home')">🏠 หน้าหลัก</div>
                <div class="nav-item" onclick="showPage('calculator')">💰 คำนวณสินเชื่อ</div>
                <div class="nav-item" onclick="showPage('scanner')">📄 สแกนสัญญา</div>
                <div class="nav-item" onclick="showPage('database')">📚 ฐานข้อมูลกฎหมาย</div>
            </div>
            <div style="display: flex; align-items: center; gap: 15px;">
                <span id="currentTime"></span>
                <div style="width: 40px; height: 40px; border-radius: 50%; background: rgba(0, 255, 65, 0.2); border: 1px solid #00ff41; display: flex; align-items: center; justify-content: center; font-weight: bold;">⚖️</div>
            </div>
        </div>
    </nav>

    <!-- Content -->
    <div class="content">
        <!-- Home Page -->
        <div id="home" class="page active">
            <div class="hero-section">
                <h1 class="hero-title">⚖️ SW.BERNHARDT</h1>
                <p class="hero-subtitle">🤖 ระบบช่วยเหลือทางกฎหมายด้วย AI</p>
                <p class="hero-description">
                    แพลตฟอร์มที่ช่วยประชาชนตรวจสอบสัญญา คำนวณสินเชื่อ และเข้าใจกฎหมายได้ง่ายขึ้น<br>
                    พัฒนาด้วยเทคโนโลยี AI เพื่อให้ความรู้ทางกฎหมายเข้าถึงได้ทุกคน<br>
                    <strong>🎯 เป้าหมาย:</strong> ป้องกันการถูกหลอกลวงและสร้างความเข้าใจในสิทธิของตนเอง
                </p>
            </div>

            <div class="feature-grid">
                <div class="feature-card" onclick="showPage('calculator')">
                    <div class="feature-icon">💰</div>
                    <h3 class="feature-title">เครื่องคำนวณสินเชื่อ</h3>
                    <p class="feature-description">
                        คำนวณดอกเบี้ย ค่างวด และตรวจสอบความถูกต้องตามกฎหมาย
                        พร้อมเตือนหากอัตราดอกเบี้ยเกินที่กฎหมายกำหนด
                    </p>
                </div>

                <div class="feature-card" onclick="showPage('scanner')">
                    <div class="feature-icon">📄</div>
                    <h3 class="feature-title">เครื่องสแกนสัญญา</h3>
                    <p class="feature-description">
                        อัปโหลดสัญญาเพื่อตรวจสอบข้อผิดกฎหมาย ข้อสัญญาไม่เป็นธรรม
                        และรับคำแนะนำทางกฎหมายที่เข้าใจง่าย
                    </p>
                </div>

                <div class="feature-card" onclick="showPage('database')">
                    <div class="feature-icon">📚</div>
                    <h3 class="feature-title">ฐานข้อมูลกฎหมาย</h3>
                    <p class="feature-description">
                        ค้นหาข้อมูลกฎหมายที่เกี่ยวข้องกับสินเชื่อและสัญญา
                        พร้อมลิงค์อ้างอิงที่เชื่อถือได้
                    </p>
                </div>
            </div>

            <div class="legal-database">
                <h2 class="database-title">🔗 แหล่งข้อมูลอ้างอิง</h2>
                <div class="law-category">
                    <h3 class="category-title">📋 หน่วยงานราชการ</h3>
                    <div class="law-item">
                        <div class="law-title">ธนาคารแห่งประเทศไทย (ธปท.)</div>
                        <div class="law-description">กำกับดูแลสถาบันการเงินและกำหนดอัตราดอกเบี้ย</div>
                        <div class="law-source">
                            <a href="https://www.bot.or.th" target="_blank" rel="noopener noreferrer" class="legal-link">
                                🌐 www.bot.or.th
                            </a>
                        </div>
                    </div>
                    <div class="law-item">
                        <div class="law-title">สำนักงานคณะกรรมการคุ้มครองผู้บริโภค</div>
                        <div class="law-description">คุ้มครองสิทธิผู้บริโภคด้านสินเชื่อและบริการทางการเงิน</div>
                        <div class="law-source">
                            <a href="https://www.ocpb.go.th" target="_blank" rel="noopener noreferrer" class="legal-link">
                                🌐 www.ocpb.go.th
                            </a>
                        </div>
                    </div>
                    <div class="law-item">
                        <div class="law-title">กรมการค้าภายใน กระทรวงพาณิชย์</div>
                        <div class="law-description">ควบคุมธุรกิจสินเชื่อเพื่อผู้บริโภค</div>
                        <div class="law-source">
                            <a href="https://www.dit.go.th" target="_blank" rel="noopener noreferrer" class="legal-link">
                                🌐 www.dit.go.th
                            </a>
                        </div>
                    </div>
                </div>

                <div class="law-category">
                    <h3 class="category-title">📜 กฎหมายที่เกี่ยวข้อง</h3>
                    <div class="law-item">
                        <div class="law-title">ประมวลกฎหมายแพ่งและพาณิชย์</div>
                        <div class="law-description">มาตรา 656 - กำหนดอัตราดอกเบี้ยสูงสุด 15% ต่อปี</div>
                        <div class="law-source">
                            <a href="https://www.krisdika.go.th/wps/portal/general/home" target="_blank" rel="noopener noreferrer" class="legal-link">
                                🌐 กฤษฎีกา - ประมวลกฎหมายแพ่งและพาณิชย์
                            </a>
                        </div>
                    </div>
                    <div class="law-item">
                        <div class="law-title">พ.ร.บ. คุ้มครองผู้บริโภค พ.ศ. 2522</div>
                        <div class="law-description">มาตรา 22 - ห้ามข้อสัญญาที่ไม่เป็นธรรมต่อผู้บริโภค</div>
                        <div class="law-source">
                            <a href="https://www.krisdika.go.th/wps/portal/general/home" target="_blank" rel="noopener noreferrer" class="legal-link">
                                🌐 กฤษฎีกา - พ.ร.บ. คุ้มครองผู้บริโภค
                            </a>
                        </div>
                    </div>
                    <div class="law-item">
                        <div class="law-title">พ.ร.บ. การควบคุมธุรกิจสินเชื่อเพื่อผู้บริโภค พ.ศ. 2560</div>
                        <div class="law-description">ควบคุมธุรกิจให้สินเชื่อแก่ผู้บริโภค</div>
                        <div class="law-source">
                            <a href="https://www.krisdika.go.th/wps/portal/general/home" target="_blank" rel="noopener noreferrer" class="legal-link">
                                🌐 กฤษฎีกา - พ.ร.บ. การควบคุมธุรกิจสินเชื่อ
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Calculator Page -->
        <div id="calculator" class="page">
            <div class="calculator-container">
                <div class="calculator-header">
                    <h1 class="calculator-title">💰 LOAN CALCULATOR</h1>
                    <p class="calculator-subtitle">🧮 เครื่องคำนวณสินเชื่อและตรวจสอบกฎหมาย</p>
                </div>

                <div class="input-row">
                    <div class="input-group">
                        <label class="input-label">💵 จำนวนเงินกู้ (บาท)</label>
                        <input type="number" id="loanAmount" class="input-field" placeholder="เช่น 100000" min="1000" max="10000000">
                    </div>
                    <div class="input-group">
                        <label class="input-label">📊 อัตราดอกเบี้ย (% ต่อปี)</label>
                        <input type="number" id="interestRate" class="input-field" placeholder="เช่น 12.5" min="0.1" max="100" step="0.1">
                    </div>
                </div>

                <div class="input-row">
                    <div class="input-group">
                        <label class="input-label">📅 ระยะเวลา (เดือน)</label>
                        <input type="number" id="loanTerm" class="input-field" placeholder="เช่น 36" min="1" max="600">
                    </div>
                    <div class="input-group">
                        <label class="input-label">🏦 ประเภทสินเชื่อ</label>
                        <select id="loanType" class="input-field">
                            <option value="personal">สินเชื่อส่วนบุคคล</option>
                            <option value="commercial">สินเชื่อพาณิชย์</option>
                            <option value="creditCard">บัตรเครดิต</option>
                            <option value="mortgage">สินเชื่อบ้าน</option>
                        </select>
                    </div>
                </div>

                <div class="action-buttons">
                    <button class="btn btn-primary" onclick="calculateLoan()">🧮 คำนวณ</button>
                    <button class="btn" onclick="clearCalculator()">🗑️ ล้างข้อมูล</button>
                </div>

                <div class="results-section" id="calculatorResults">
                    <h2 class="results-title">📊 ผลการคำนวณ</h2>
                    <div id="calculationResults"></div>
                </div>
            </div>
        </div>

        <!-- Scanner Page -->
        <div id="scanner" class="page">
            <div class="scanner-container">
                <div class="scanner-header">
                    <h1 class="scanner-title">📄 CONTRACT SCANNER</h1>
                    <p class="scanner-subtitle">🔍 AI Legal Document Analysis System</p>
                </div>

                <div class="upload-section" id="uploadSection" onclick="document.getElementById('fileInput').click()">
                    <div class="upload-icon">📄</div>
                    <div class="upload-text">อัปโหลดสัญญาหรือเอกสารกฎหมาย</div>
                    <div class="upload-subtext">
                        รองรับไฟล์: PDF, JPG, PNG, DOCX, TXT<br>
                        ขนาดไฟล์สูงสุด: 10MB<br>
                        ลากและวางไฟล์ที่นี่ หรือคลิกเพื่อเลือกไฟล์
                    </div>
                    <button class="upload-btn">📁 เลือกไฟล์</button>
                    <input type="file" id="fileInput" class="file-input" accept=".pdf,.jpg,.jpeg,.png,.docx,.txt" multiple>
                </div>

                <div class="file-preview" id="filePreview">
                    <div class="file-info">
                        <span class="file-name" id="fileName">ไม่มีไฟล์</span>
                        <span class="file-size" id="fileSize">0 KB</span>
                    </div>
                    <img class="preview-image" id="previewImage" style="display: none;">
                    <div class="action-buttons">
                        <button class="btn btn-primary" onclick="analyzeContract()">🔍 วิเคราะห์สัญญา</button>
                        <button class="btn" onclick="clearFile()">🗑️ ลบไฟล์</button>
                    </div>
                </div>

                <div class="analysis-section" id="analysisSection">
                    <h2 class="analysis-title">🔍 กำลังวิเคราะห์เอกสาร...</h2>
                    <div class="scanning-animation">
                        <div class="scanning-text" id="scanningText">กำลังสแกนเอกสาร...</div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="progressFill"></div>
                        </div>
                        <div id="scanningSteps">
                            <div>📄 อ่านเนื้อหาเอกสาร...</div>
                        </div>
                    </div>
                </div>

                <div class="results-container" id="resultsContainer">
                    <div class="contract-summary">
                        <h2 class="summary-title">📋 สรุปข้อมูลสัญญา</h2>
                        <div id="contractSummary"></div>
                    </div>

                    <div class="legal-issues">
                        <h2 class="summary-title">⚖️ ประเด็นทางกฎหมาย</h2>
                        <div id="legalIssues"></div>
                    </div>

                    <div class="action-buttons">
                        <button class="btn btn-primary" onclick="generateReport()">📊 สร้างรายงาน</button>
                        <button class="btn" onclick="exportAnalysis()">💾 ส่งออกผลวิเคราะห์</button>
                        <button class="btn btn-danger" onclick="resetScanner()">🔄 สแกนใหม่</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Legal Database Page -->
        <div id="database" class="page">
            <div class="legal-database">
                <h1 class="database-title">📚 ฐานข้อมูลกฎหมาย</h1>
                
                <div class="law-category">
                    <h3 class="category-title">💰 กฎหมายเกี่ยวกับดอกเบี้ย</h3>
                    <div class="law-item">
                        <div class="law-title">อัตราดอกเบี้ยสูงสุดตามกฎหมาย</div>
                        <div class="law-description">
                            ประมวลกฎหมายแพ่งและพาณิชย์ มาตรา 656 กำหนดอัตราดอกเบี้ยสูงสุด 15% ต่อปี
                            หากเรียกดอกเบี้ยเกินอัตรานี้ ส่วนเกินจะถือเป็นโมฆะ
                        </div>
                        <div class="law-source">
                            <a href="https://www.krisdika.go.th/wps/portal/general/home" target="_blank" rel="noopener noreferrer" class="legal-link">
                                📜 ประมวลกฎหมายแพ่งและพาณิชย์ มาตรา 656
                            </a>
                        </div>
                    </div>
                    <div class="law-item">
                        <div class="law-title">ประกาศธนาคารแห่งประเทศไทย</div>
                        <div class="law-description">
                            กำหนดอัตราดอกเบี้ยสำหรับสถาบันการเงินต่างๆ และหลักเกณท์การให้สินเชื่อ
                        </div>
                        <div class="law-source">
                            <a href="https://www.bot.or.th/th/financial-institutions/regulations" target="_blank" rel="noopener noreferrer" class="legal-link">
                                🏦 ประกาศ ธปท. เรื่องอัตราดอกเบี้ย
                            </a>
                        </div>
                    </div>
                </div>

                <div class="law-category">
                    <h3 class="category-title">📋 กฎหมายคุ้มครองผู้บริโภค</h3>
                    <div class="law-item">
                        <div class="law-title">พ.ร.บ. คุ้มครองผู้บริโภค พ.ศ. 2522</div>
                        <div class="law-description">
                            มาตรา 22 ห้ามผู้ประกอบการกำหนดข้อสัญญาที่ไม่เป็นธรรมต่อผู้บริโภค
                            ผู้ฝ่าฝืนมีโทษปรับไม่เกิน 100,000 บาท หรือจำคุกไม่เกิน 1 ปี
                        </div>
                        <div class="law-source">
                            <a href="https://www.ocpb.go.th/law" target="_blank" rel="noopener noreferrer" class="legal-link">
                                ⚖️ พ.ร.บ. คุ้มครองผู้บริโภค
                            </a>
                        </div>
                    </div>
                    <div class="law-item">
                        <div class="law-title">การเปิดเผยข้อมูลสินเชื่อ</div>
                        <div class="law-description">
                            ผู้ให้สินเชื่อต้องเปิดเผยข้อมูลอัตราดอกเบี้ย ค่าธรรมเนียม และเงื่อนไขต่างๆ อย่างชัดเจน
                        </div>
                        <div class="law-source">
                            <a href="https://www.bot.or.th/th/financial-institutions/regulations" target="_blank" rel="noopener noreferrer" class="legal-link">
                                📊 หลักเกณท์การเปิดเผยข้อมูล
                            </a>
                        </div>
                    </div>
                </div>

                <div class="law-category">
                    <h3 class="category-title">🏢 กฎหมายธุรกิจสินเชื่อ</h3>
                    <div class="law-item">
                        <div class="law-title">พ.ร.บ. การควบคุมธุรกิจสินเชื่อเพื่อผู้บริโภค พ.ศ. 2560</div>
                        <div class="law-description">
                            ควบคุมธุรกิจให้สินเชื่อแก่ผู้บริโภค กำหนดหลักเกณท์การประกอบธุรกิจ
                            ผู้ฝ่าฝืนมีโทษปรับไม่เกิน 1,000,000 บาท หรือจำคุกไม่เกิน 2 ปี
                        </div>
                        <div class="law-source">
                            <a href="https://www.dit.go.th/content/category/detail/id/545" target="_blank" rel="noopener noreferrer" class="legal-link">
                                🏛️ พ.ร.บ. การควบคุมธุรกิจสินเชื่อ
                            </a>
                        </div>
                    </div>
                    <div class="law-item">
                        <div class="law-title">การขึ้นทะเบียนผู้ประกอบธุรกิจสินเชื่อ</div>
                        <div class="law-description">
                            ผู้ประกอบธุรกิจสินเชื่อต้องขึ้นทะเบียนกับกรมการค้าภายใน
                        </div>
                        <div class="law-source">
                            <a href="https://www.dit.go.th/content/category/detail/id/545" target="_blank" rel="noopener noreferrer" class="legal-link">
                                📝 ทะเบียนผู้ประกอบธุรกิจสินเชื่อ
                            </a>
                        </div>
                    </div>
                </div>

                <div class="law-category">
                    <h3 class="category-title">⚖️ กระบวนการทางกฎหมาย</h3>
                    <div class="law-item">
                        <div class="law-title">การยึดทรัพย์สินหลักประกัน</div>
                        <div class="law-description">
                            ต้องผ่านกระบวนการศาลตามประมวลกฎหมายวิธีพิจารณาความแพ่ง
                            การยึดทรัพย์โดยไม่ผ่านศาลถือเป็นการกระทำผิดกฎหมาย
                        </div>
                        <div class="law-source">
                            <a href="https://www.krisdika.go.th/wps/portal/general/home" target="_blank" rel="noopener noreferrer" class="legal-link">
                                ⚖️ ประมวลกฎหมายวิธีพิจารณาความแพ่ง
                            </a>
                        </div>
                    </div>
                    <div class="law-item">
                        <div class="law-title">การร้องเรียนและการฟ้องร้อง</div>
                        <div class="law-description">
                            ผู้บริโภคสามารถร้องเรียนต่อสำนักงานคุ้มครองผู้บริโภคหรือฟ้องร้องต่อศาล
                        </div>
                        <div class="law-source">
                            <a href="https://www.ocpb.go.th/complaint" target="_blank" rel="noopener noreferrer" class="legal-link">
                                📞 ช่องทางร้องเรียน OCPB
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <div class="footer">
        <div class="footer-content">
            <h3 class="footer-title">⚖️ SW.BERNHARDT Legal Assistant</h3>
            <p class="footer-text">
                ระบบช่วยเหลือทางกฎหมายด้วย AI เพื่อประชาชน<br>
                ข้อมูลในระบบนี้เป็นการให้คำปรึกษาเบื้องต้นเท่านั้น<br>
                สำหรับคำแนะนำทางกฎหมายที่เฉพาะเจาะจง ควรปรึกษาทนายความ
            </p>
            <div class="footer-links">
                <a href="https://www.bot.or.th" target="_blank" rel="noopener noreferrer" class="footer-link">
                    🏦 ธนาคารแห่งประเทศไทย
                </a>
                <a href="https://www.ocpb.go.th" target="_blank" rel="noopener noreferrer" class="footer-link">
                    🛡️ สำนักงานคุ้มครองผู้บริโภค
                </a>
                <a href="https://www.dit.go.th" target="_blank" rel="noopener noreferrer" class="footer-link">
                    🏛️ กรมการค้าภายใน
                </a>
                <a href="https://www.krisdika.go.th" target="_blank" rel="noopener noreferrer" class="footer-link">
                    📜 สำนักงานคณะกรรมการกฤษฎีกา
                </a>
            </div>
        </div>
    </div>

    <!-- Notification -->
    <div id="notification" class="notification"></div>

    <script>
        // Global Variables
        let matrixRunning = true;
        let scannerRunning = true;
        let animationSpeed = 1;
        let matrixCanvas, matrixCtx;
        let matrixChars = [];
        let currentFile = null;
        let analysisResults = null;
        let currentPage = 'home';

        // Legal Database
        const LEGAL_DATABASE = {
            interestRates: {
                commercial: { max: 15.0, law: 'ประกาศ ธปท. เรื่อง อัตราดอกเบี้ยเงินกู้' },
                personal: { max: 28.0, law: 'ประกาศ ธปท. เรื่อง หลักเกณท์การให้สินเชื่อ' },
                creditCard: { max: 18.0, law: 'ประกาศ ธปท. เรื่อง การออกบัตรเครดิต' },
                mortgage: { max: 12.0, law: 'ประกาศ ธปท. เรื่อง สินเชื่อที่อยู่อาศัย' },
                maximum: { max: 15.0, law: 'ประมวลกฎหมายแพ่งและพาณิชย์ มาตรา 656' }
            },
            contractTerms: {
                unfairTerms: [
                    'ผู้กู้ต้องรับผิดชอบค่าใช้จ่ายทั้งหมดในการติดตาม',
                    'ผู้ให้กู้มีสิทธิ์เปลี่ยนแปลงเงื่อนไขได้ตลอดเวลา',
                    'ผู้กู้สละสิทธิ์ในการฟ้องร้อง',
                    'การยึดทรัพย์สินโดยไม่ผ่านศาล'
                ],
                requiredClauses: [
                    'อัตราดอกเบี้ยที่ชัดเจน',
                    'วันครบกำหนดชำระ',
                    'จำนวนเงินต้น',
                    'ค่าปรับหรือค่าธรรมเนียม'
                ]
            },
            penalties: {
                excessiveInterest: {
                    law: 'ประมวลกฎหมายแพ่งและพาณิชย์ มาตรา 656',
                    penalty: 'การเรียกดอกเบี้ยเกินอัตราที่กฎหมายกำหนด ถือเป็นโมฆะ',
                    link: 'https://www.krisdika.go.th/wps/portal/general/home'
                },
                unfairContract: {
                    law: 'พ.ร.บ. คุมครองผู้บริโภค พ.ศ. 2522 มาตรา 22',
                    penalty: 'ปรับไม่เกิน 100,000 บาท หรือจำคุกไม่เกิน 1 ปี หรือทั้งจำทั้งปรับ',
                    link: 'https://www.ocpb.go.th/law'
                },
                illegalLending: {
                    law: 'พ.ร.บ. การควบคุมธุรกิจสินเชื่อเพื่อผู้บริโภค พ.ศ. 2560',
                    penalty: 'ปรับไม่เกิน 1,000,000 บาท หรือจำคุกไม่เกิน 2 ปี หรือทั้งจำทั้งปรับ',
                    link: 'https://www.dit.go.th/content/category/detail/id/545'
                }
            }
        };

        // Matrix Rain Effect
        const matrixText = 'アイウエオカキクケコサシスセソタチツテトナニヌネノハヒフヘホマミムメモヤユヨラリルレロワヲンガギグゲゴザジズゼゾダヂヅデドバビブベボパピプペポ0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ₿$¥€£₹₩';
        
        function initMatrix() {
            matrixCanvas = document.getElementById('matrix-canvas');
            matrixCtx = matrixCanvas.getContext('2d');
            
            resizeMatrix();
            
            const fontSize = 16;
            const columns = matrixCanvas.width / fontSize;
            
            for (let i = 0; i < columns; i++) {
                matrixChars[i] = 1;
            }
            
            animateMatrix();
        }

        function resizeMatrix() {
            matrixCanvas.width = window.innerWidth;
            matrixCanvas.height = window.innerHeight;
        }

        function animateMatrix() {
            if (matrixRunning) {
                matrixCtx.fillStyle = 'rgba(0, 0, 0, 0.15)';
                matrixCtx.fillRect(0, 0, matrixCanvas.width, matrixCanvas.height);
                
                matrixCtx.fillStyle = 'rgba(0, 255, 65, 0.3)';
                matrixCtx.font = '12px Courier New';
                
                for (let i = 0; i < matrixChars.length; i++) {
                    if (Math.random() > 0.9) {
                        const text = matrixText[Math.floor(Math.random() * matrixText.length)];
                        matrixCtx.fillText(text, i * 20, matrixChars[i] * 20);
                    }
                    
                    if (matrixChars[i] * 20 > matrixCanvas.height && Math.random() > 0.98) {
                        matrixChars[i] = 0;
                    }
                    matrixChars[i] += animationSpeed * 0.5;
                }
            }
            
            requestAnimationFrame(animateMatrix);
        }

        // Navigation Functions
        function showPage(pageId) {
            // Hide all pages
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            // Remove active class from all nav items
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Show selected page
            document.getElementById(pageId).classList.add('active');
            
            // Add active class to corresponding nav item
            const navItems = document.querySelectorAll('.nav-item');
            const pageIndex = ['home', 'calculator', 'scanner', 'database'].indexOf(pageId);
            if (pageIndex >= 0 && navItems[pageIndex]) {
                navItems[pageIndex].classList.add('active');
            }
            
            currentPage = pageId;
            showNotification(`เปลี่ยนไปหน้า${getPageName(pageId)}`);
        }

        function getPageName(pageId) {
            const names = {
                home: 'หลัก',
                calculator: 'คำนวณสินเชื่อ',
                scanner: 'สแกนสัญญา',
                database: 'ฐานข้อมูลกฎหมาย'
            };
            return names[pageId] || pageId;
        }

        // Control Functions
        function toggleMatrix() {
            matrixRunning = !matrixRunning;
            const btn = document.getElementById('matrixBtn');
            btn.textContent = matrixRunning ? '⏸️ Matrix' : '▶️ Matrix';
        }

        function toggleScanner() {
            scannerRunning = !scannerRunning;
            const scanner = document.querySelector('.scanner');
            const btn = document.getElementById('scannerBtn');
            
            scanner.style.animationPlayState = scannerRunning ? 'running' : 'paused';
            btn.textContent = scannerRunning ? '📡 Scan' : '📡 Scan';
        }

        function changeSpeed() {
            animationSpeed = animationSpeed === 1 ? 2 : animationSpeed === 2 ? 0.5 : 1;
            const btn = document.getElementById('speedBtn');
            btn.textContent = `⚡ ${animationSpeed}x`;
            showNotification(`เปลี่ยนความเร็วเป็น ${animationSpeed}x`);
        }

        // Calculator Functions
        function calculateLoan() {
            const loanAmount = parseFloat(document.getElementById('loanAmount').value);
            const interestRate = parseFloat(document.getElementById('interestRate').value);
            const loanTerm = parseInt(document.getElementById('loanTerm').value);
            const loanType = document.getElementById('loanType').value;

            if (!loanAmount || !interestRate || !loanTerm) {
                showNotification('กรุณากรอกข้อมูลให้ครบถ้วน', 'error');
                return;
            }

            if (loanAmount < 1000 || loanAmount > 10000000) {
                showNotification('จำนวนเงินกู้ต้องอยู่ระหว่าง 1,000 - 10,000,000 บาท', 'error');
                return;
            }

            // Calculate loan details
            const monthlyRate = interestRate / 100 / 12;
            const monthlyPayment = loanAmount * (monthlyRate * Math.pow(1 + monthlyRate, loanTerm)) / (Math.pow(1 + monthlyRate, loanTerm) - 1);
            const totalPayment = monthlyPayment * loanTerm;
            const totalInterest = totalPayment - loanAmount;

            // Check legal compliance
            const legalCheck = checkLegalCompliance(interestRate, loanType);

            displayCalculatorResults({
                loanAmount,
                interestRate,
                loanTerm,
                loanType,
                monthlyPayment,
                totalPayment,
                totalInterest,
                legalCheck
            });

            showNotification('คำนวณเสร็จสิ้น!');
        }

        function checkLegalCompliance(interestRate, loanType) {
            const maxRates = LEGAL_DATABASE.interestRates;
            let maxAllowed = maxRates.maximum.max;
            let applicableLaw = maxRates.maximum.law;

            // Check specific loan type limits
            if (maxRates[loanType]) {
                maxAllowed = maxRates[loanType].max;
                applicableLaw = maxRates[loanType].law;
            }

            const isLegal = interestRate <= maxAllowed;
            const isExcessive = interestRate > maxRates.maximum.max;

            return {
                isLegal,
                isExcessive,
                maxAllowed,
                applicableLaw,
                excessAmount: isExcessive ? interestRate - maxRates.maximum.max : 0
            };
        }

        function displayCalculatorResults(results) {
            const resultsContainer = document.getElementById('calculatorResults');
            const resultsDiv = document.getElementById('calculationResults');

            const loanTypeNames = {
                personal: 'สินเชื่อส่วนบุคคล',
                commercial: 'สินเชื่อพาณิชย์',
                creditCard: 'บัตรเครดิต',
                mortgage: 'สินเชื่อบ้าน'
            };

            let legalWarning = '';
            if (!results.legalCheck.isLegal) {
                legalWarning = `
                    <div class="result-item">
                        <span class="result-label">⚠️ คำเตือนทางกฎหมาย:</span>
                        <span class="result-value danger">อัตราดอกเบี้ยเกินกฎหมาย!</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">📏 อัตราสูงสุดที่กฎหมายอนุญาต:</span>
                        <span class="result-value">${results.legalCheck.maxAllowed}% ต่อปี</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">📜 กฎหมายอ้างอิง:</span>
                        <span class="result-value">${results.legalCheck.applicableLaw}</span>
                    </div>
                `;
            }

            resultsDiv.innerHTML = `
                <div class="result-item">
                    <span class="result-label">💰 จำนวนเงินกู้:</span>
                    <span class="result-value">${results.loanAmount.toLocaleString()} บาท</span>
                </div>
                <div class="result-item">
                    <span class="result-label">📊 อัตราดอกเบี้ย:</span>
                    <span class="result-value ${!results.legalCheck.isLegal ? 'danger' : ''}">${results.interestRate}% ต่อปี</span>
                </div>
                <div class="result-item">
                    <span class="result-label">📅 ระยะเวลา:</span>
                    <span class="result-value">${results.loanTerm} เดือน</span>
                </div>
                <div class="result-item">
                    <span class="result-label">🏦 ประเภทสินเชื่อ:</span>
                    <span class="result-value">${loanTypeNames[results.loanType]}</span>
                </div>
                <div class="result-item">
                    <span class="result-label">💳 ค่างวดรายเดือน:</span>
                    <span class="result-value highlight">${Math.round(results.monthlyPayment).toLocaleString()} บาท</span>
                </div>
                <div class="result-item">
                    <span class="result-label">💸 ดอกเบี้ยรวม:</span>
                    <span class="result-value">${Math.round(results.totalInterest).toLocaleString()} บาท</span>
                </div>
                <div class="result-item">
                    <span class="result-label">💰 ยอดชำระรวม:</span>
                    <span class="result-value highlight">${Math.round(results.totalPayment).toLocaleString()} บาท</span>
                </div>
                ${legalWarning}
                <div class="result-item">
                    <span class="result-label">✅ สถานะทางกฎหมาย:</span>
                    <span class="result-value ${results.legalCheck.isLegal ? '' : 'danger'}">
                        ${results.legalCheck.isLegal ? 'ถูกต้องตามกฎหมาย' : 'ผิดกฎหมาย'}
                    </span>
                </div>
            `;

            resultsContainer.style.display = 'block';
        }

        function clearCalculator() {
            document.getElementById('loanAmount').value = '';
            document.getElementById('interestRate').value = '';
            document.getElementById('loanTerm').value = '';
            document.getElementById('loanType').value = 'personal';
            document.getElementById('calculatorResults').style.display = 'none';
            showNotification('ล้างข้อมูลเรียบร้อย');
        }

        // File Upload Functions
        function setupFileUpload() {
            const fileInput = document.getElementById('fileInput');
            const uploadSection = document.getElementById('uploadSection');

            fileInput.addEventListener('change', handleFileSelect);

            // Drag and drop functionality
            uploadSection.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadSection.classList.add('dragover');
            });

            uploadSection.addEventListener('dragleave', (e) => {
                e.preventDefault();
                uploadSection.classList.remove('dragover');
            });

            uploadSection.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadSection.classList.remove('dragover');
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    handleFile(files[0]);
                }
            });
        }

        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (file) {
                handleFile(file);
            }
        }

        function handleFile(file) {
            // Validate file type
            const allowedTypes = ['application/pdf', 'image/jpeg', 'image/png', 'image/jpg', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document', 'text/plain'];
            
            if (!allowedTypes.includes(file.type)) {
                showNotification('ประเภทไฟล์ไม่รองรับ กรุณาเลือกไฟล์ PDF, JPG, PNG, DOCX หรือ TXT', 'error');
                return;
            }

            // Validate file size (10MB)
            if (file.size > 10 * 1024 * 1024) {
                showNotification('ไฟล์มีขนาดใหญ่เกินไป (สูงสุด 10MB)', 'error');
                return;
            }

            currentFile = file;
            displayFilePreview(file);
            showNotification('อัปโหลดไฟล์สำเร็จ!');
        }

        function displayFilePreview(file) {
            const filePreview = document.getElementById('filePreview');
            const fileName = document.getElementById('fileName');
            const fileSize = document.getElementById('fileSize');
            const previewImage = document.getElementById('previewImage');

            fileName.textContent = file.name;
            fileSize.textContent = formatFileSize(file.size);

            // Show image preview if it's an image file
            if (file.type.startsWith('image/')) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    previewImage.src = e.target.result;
                    previewImage.style.display = 'block';
                };
                reader.readAsDataURL(file);
            } else {
                previewImage.style.display = 'none';
            }

            filePreview.style.display = 'block';
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        function clearFile() {
            currentFile = null;
            document.getElementById('fileInput').value = '';
            document.getElementById('filePreview').style.display = 'none';
            document.getElementById('resultsContainer').style.display = 'none';
            showNotification('ลบไฟล์เรียบร้อย');
        }

        // Contract Analysis Functions
        function analyzeContract() {
            if (!currentFile) {
                showNotification('กรุณาเลือกไฟล์ก่อนวิเคราะห์', 'error');
                return;
            }

            const analysisSection = document.getElementById('analysisSection');
            analysisSection.style.display = 'block';

            // Simulate analysis process
            simulateAnalysis();
        }

        function simulateAnalysis() {
            const steps = [
                { text: '📄 อ่านเนื้อหาเอกสาร...', progress: 10 },
                { text: '🔍 ตรวจสอบโครงสร้างสัญญา...', progress: 25 },
                { text: '📊 วิเคราะห์อัตราดอกเบี้ย...', progress: 40 },
                { text: '⚖️ ตรวจสอบข้อกฎหมาย...', progress: 60 },
                { text: '🚨 ค้นหาข้อผิดกฎหมาย...', progress: 80 },
                { text: '📋 สร้างรายงานผลวิเคราะห์...', progress: 95 },
                { text: '✅ วิเคราะห์เสร็จสิ้น!', progress: 100 }
            ];

            let currentStep = 0;
            const scanningText = document.getElementById('scanningText');
            const progressFill = document.getElementById('progressFill');
            const scanningSteps = document.getElementById('scanningSteps');

            function nextStep() {
                if (currentStep < steps.length) {
                    const step = steps[currentStep];
                    scanningText.textContent = step.text;
                    progressFill.style.width = step.progress + '%';
                    
                    // Add step to history
                    const stepDiv = document.createElement('div');
                    stepDiv.textContent = step.text;
                    stepDiv.style.opacity = '0.7';
                    stepDiv.style.marginBottom = '5px';
                    scanningSteps.appendChild(stepDiv);

                    currentStep++;
                    
                    if (currentStep < steps.length) {
                        setTimeout(nextStep, 1000 + Math.random() * 1000);
                    } else {
                        setTimeout(() => {
                            document.getElementById('analysisSection').style.display = 'none';
                            displayAnalysisResults();
                        }, 1000);
                    }
                }
            }

            nextStep();
        }

        function displayAnalysisResults() {
            // Generate mock analysis results
            analysisResults = generateMockAnalysis();
            
            // Display contract summary
            displayContractSummary(analysisResults.summary);
            
            // Display legal issues
            displayLegalIssues(analysisResults.issues);
            
            // Show results container
            document.getElementById('resultsContainer').style.display = 'block';
            
            showNotification('วิเคราะห์เอกสารเสร็จสิ้น!');
        }

        function generateMockAnalysis() {
            // This would normally use OCR and AI analysis
            // For demo purposes, we'll generate realistic mock data
            return {
                summary: {
                    contractType: 'สัญญาเงินกู้',
                    lender: 'บริษัท ABC สินเชื่อ จำกัด',
                    borrower: 'นาย/นาง [ชื่อผู้กู้]',
                    principalAmount: '500,000 บาท',
                    interestRate: '36% ต่อปี',
                    loanTerm: '24 เดือน',
                    monthlyPayment: '28,500 บาท',
                    totalPayment: '684,000 บาท',
                    collateral: 'รถยนต์ป้ายแดง',
                    contractDate: '15 มกราคม 2567'
                },
                issues: [
                    {
                        type: 'critical',
                        title: 'อัตราดอกเบี้ยเกินกฎหมาย',
                        description: 'อัตราดอกเบี้ย 36% ต่อปี เกินอัตราสูงสุดที่กฎหมายกำหนด (15% ต่อปี)',
                        law: 'ประมวลกฎหมายแพ่งและพาณิชย์ มาตรา 656',
                        penalty: 'การเรียกดอกเบี้ยเกินอัตราที่กฎหมายกำหนด ถือเป็นโมฆะ',
                        recommendation: 'ผู้กู้สามารถปฏิเสธการชำระดอกเบี้ยส่วนเกิน และฟ้องเรียกคืนเงินที่จ่ายไปแล้ว',
                        link: 'https://www.krisdika.go.th/wps/portal/general/home'
                    },
                    {
                        type: 'critical',
                        title: 'ข้อสัญญาไม่เป็นธรรม',
                        description: 'มีข้อกำหนดให้ผู้กู้รับผิดชอบค่าใช้จ่ายในการติดตามทวงถามทั้งหมด',
                        law: 'พ.ร.บ. คุ้มครองผู้บริโภค พ.ศ. 2522 มาตรา 22',
                        penalty: 'ปรับไม่เกิน 100,000 บาท หรือจำคุกไม่เกิน 1 ปี หรือทั้งจำทั้งปรับ',
                        recommendation: 'ข้อสัญญานี้อาจถือเป็นโมฆะ ผู้กู้ไม่จำเป็นต้องปฏิบัติตาม',
                        link: 'https://www.ocpb.go.th/law'
                    },
                    {
                        type: 'warning',
                        title: 'การยึดทรัพย์สินไม่ชัดเจน',
                        description: 'ไม่ระบุขั้นตอนการยึดทรัพย์สินหลักประกันอย่างชัดเจน',
                        law: 'ประมวลกฎหมายวิธีพิจารณาความแพ่ง มาตรา 240',
                        penalty: 'การยึดทรัพย์โดยไม่ผ่านศาลถือเป็นการกระทำผิดกฎหมาย',
                        recommendation: 'ควรเพิ่มข้อกำหนดให้การยึดทรัพย์ต้องผ่านกระบวนการศาล',
                        link: 'https://www.krisdika.go.th/wps/portal/general/home'
                    },
                    {
                        type: 'info',
                        title: 'ข้อมูลไม่ครบถ้วน',
                        description: 'ไม่ระบุค่าธรรมเนียมและค่าใช้จ่ายอื่นๆ อย่างชัดเจน',
                        law: 'ประกาศ ธปท. เรื่อง หลักเกณท์การเปิดเผยข้อมูล',
                        penalty: 'ผู้ให้กู้อาจถูกปรับตามระเบียบของธนาคารแห่งประเทศไทย',
                        recommendation: 'ควรเรียกร้องให้ระบุค่าใช้จ่ายทั้งหมดอย่างชัดเจน',
                        link: 'https://www.bot.or.th/th/financial-institutions/regulations'
                    }
                ]
            };
        }

        function displayContractSummary(summary) {
            const summaryContainer = document.getElementById('contractSummary');
            summaryContainer.innerHTML = '';

            Object.entries(summary).forEach(([key, value]) => {
                const item = document.createElement('div');
                item.className = 'summary-item';
                
                const label = document.createElement('span');
                label.className = 'summary-label';
                label.textContent = getThaiLabel(key);
                
                const valueSpan = document.createElement('span');
                valueSpan.className = 'summary-value';
                valueSpan.textContent = value;
                
                item.appendChild(label);
                item.appendChild(valueSpan);
                summaryContainer.appendChild(item);
            });
        }

        function getThaiLabel(key) {
            const labels = {
                contractType: 'ประเภทสัญญา:',
                lender: 'ผู้ให้กู้:',
                borrower: 'ผู้กู้:',
                principalAmount: 'จำนวนเงินกู้:',
                interestRate: 'อัตราดอกเบี้ย:',
                loanTerm: 'ระยะเวลา:',
                monthlyPayment: 'ค่างวดรายเดือน:',
                totalPayment: 'ยอดชำระรวม:',
                collateral: 'หลักประกัน:',
                contractDate: 'วันที่ทำสัญญา:'
            };
            return labels[key] || key;
        }

        function displayLegalIssues(issues) {
            const issuesContainer = document.getElementById('legalIssues');
            issuesContainer.innerHTML = '';

            issues.forEach(issue => {
                const issueCard = document.createElement('div');
                issueCard.className = `issue-card ${issue.type}`;

                const header = document.createElement('div');
                header.className = 'issue-header';

                const icon = document.createElement('span');
                icon.className = 'issue-icon';
                icon.textContent = getIssueIcon(issue.type);

                const title = document.createElement('span');
                title.className = 'issue-title';
                title.textContent = issue.title;

                const severity = document.createElement('span');
                severity.className = `issue-severity severity-${issue.type}`;
                severity.textContent = getSeverityText(issue.type);

                header.appendChild(icon);
                header.appendChild(title);
                header.appendChild(severity);

                const description = document.createElement('div');
                description.className = 'issue-description';
                description.textContent = issue.description;

                const legalRef = document.createElement('div');
                legalRef.className = 'legal-reference';
                legalRef.innerHTML = `<strong>📜 กฎหมายอ้างอิง:</strong> 
                    <a href="${issue.link}" target="_blank" rel="noopener noreferrer" class="legal-link">${issue.law}</a>`;

                const penalty = document.createElement('div');
                penalty.className = 'penalty-info';
                penalty.innerHTML = `
                    <div class="penalty-title">⚖️ บทลงโทษ:</div>
                    <div>${issue.penalty}</div>
                `;

                const recommendation = document.createElement('div');
                recommendation.className = 'legal-reference';
                recommendation.innerHTML = `<strong>💡 คำแนะนำ:</strong> ${issue.recommendation}`;

                issueCard.appendChild(header);
                issueCard.appendChild(description);
                issueCard.appendChild(legalRef);
                issueCard.appendChild(penalty);
                issueCard.appendChild(recommendation);

                issuesContainer.appendChild(issueCard);
            });
        }

        function getIssueIcon(type) {
            const icons = {
                critical: '🚨',
                warning: '⚠️',
                info: 'ℹ️'
            };
            return icons[type] || 'ℹ️';
        }

        function getSeverityText(type) {
            const texts = {
                critical: 'วิกฤต',
                warning: 'เตือน',
                info: 'ข้อมูล'
            };
            return texts[type] || 'ข้อมูล';
        }

        // Report Functions
        function generateReport() {
            if (!analysisResults) {
                showNotification('ไม่มีข้อมูลการวิเคราะห์', 'error');
                return;
            }

            showNotification('กำลังสร้างรายงาน...');

            setTimeout(() => {
                const reportWindow = window.open('', '_blank');
                const reportContent = generateReportHTML();
                
                reportWindow.document.write(reportContent);
                reportWindow.document.close();
                reportWindow.print();
                
                showNotification('เปิดหน้าต่างพิมพ์รายงานเรียบร้อย!');
            }, 1000);
        }

        function generateReportHTML() {
            const currentDate = new Date().toLocaleDateString('th-TH');
            const summary = analysisResults.summary;
            const issues = analysisResults.issues;

            return `
                <!DOCTYPE html>
                <html>
                <head>
                    <meta charset="utf-8">
                    <title>SW.BERNHARDT Contract Analysis Report</title>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 20px; line-height: 1.6; }
                        .header { text-align: center; margin-bottom: 30px; border-bottom: 2px solid #2c5aa0; padding-bottom: 20px; }
                        .logo { font-size: 24px; font-weight: bold; color: #2c5aa0; margin-bottom: 10px; }
                        .title { font-size: 20px; color: #333; }
                        .section { margin: 20px 0; }
                        .section-title { font-size: 18px; font-weight: bold; color: #2c5aa0; margin-bottom: 15px; border-bottom: 1px solid #ddd; padding-bottom: 5px; }
                        table { width: 100%; border-collapse: collapse; margin: 15px 0; }
                        th, td { border: 1px solid #ddd; padding: 10px; text-align: left; }
                        th { background: #f2f2f2; font-weight: bold; }
                        .issue-critical { background: #ffe6e6; border-left: 4px solid #ff0000; }
                        .issue-warning { background: #fff9e6; border-left: 4px solid #ffaa00; }
                        .issue-info { background: #e6f3ff; border-left: 4px solid #0066cc; }
                        .issue-box { margin: 15px 0; padding: 15px; border-radius: 5px; }
                        .footer { margin-top: 40px; text-align: center; font-size: 12px; color: #666; }
                        .legal-link { color: #2c5aa0; text-decoration: underline; }
                    </style>
                </head>
                <body>
                    <div class="header">
                        <div class="logo">⚖️ SW.BERNHARDT</div>
                        <div class="title">รายงานการวิเคราะห์สัญญา</div>
                        <div>วันที่: ${currentDate}</div>
                    </div>

                    <div class="section">
                        <div class="section-title">📋 สรุปข้อมูลสัญญา</div>
                        <table>
                            ${Object.entries(summary).map(([key, value]) => 
                                `<tr><td><strong>${getThaiLabel(key)}</strong></td><td>${value}</td></tr>`
                            ).join('')}
                        </table>
                    </div>

                    <div class="section">
                        <div class="section-title">⚖️ ประเด็นทางกฎหมาย</div>
                        ${issues.map(issue => `
                            <div class="issue-box issue-${issue.type}">
                                <h4>${getIssueIcon(issue.type)} ${issue.title} (${getSeverityText(issue.type)})</h4>
                                <p><strong>รายละเอียด:</strong> ${issue.description}</p>
                                <p><strong>กฎหมายอ้างอิง:</strong> <a href="${issue.link}" class="legal-link">${issue.law}</a></p>
                                <p><strong>บทลงโทษ:</strong> ${issue.penalty}</p>
                                <p><strong>คำแนะนำ:</strong> ${issue.recommendation}</p>
                            </div>
                        `).join('')}
                    </div>

                    <div class="footer">
                        <p>รายงานนี้สร้างโดยระบบ SW.BERNHARDT Legal Assistant Platform</p>
                        <p>เพื่อการศึกษาและให้คำปรึกษาเบื้องต้นเท่านั้น ควรปรึกษาทนายความสำหรับคำแนะนำทางกฎหมายที่เฉพาะเจาะจง</p>
                        <p>แหล่งข้อมูลอ้างอิง: ธนาคารแห่งประเทศไทย, สำนักงานคุ้มครองผู้บริโภค, กรมการค้าภายใน, สำนักงานคณะกรรมการกฤษฎีกา</p>
                    </div>
                </body>
                </html>
            `;
        }

        function exportAnalysis() {
            if (!analysisResults) {
                showNotification('ไม่มีข้อมูลการวิเคราะห์', 'error');
                return;
            }

            const data = {
                timestamp: new Date().toISOString(),
                fileName: currentFile ? currentFile.name : 'unknown',
                analysis: analysisResults,
                legalReferences: {
                    bot: 'https://www.bot.or.th',
                    ocpb: 'https://www.ocpb.go.th',
                    dit: 'https://www.dit.go.th',
                    krisdika: 'https://www.krisdika.go.th'
                }
            };

            const jsonString = JSON.stringify(data, null, 2);
            const blob = new Blob([jsonString], { type: 'application/json' });
            const url = URL.createObjectURL(blob);

            const a = document.createElement('a');
            a.href = url;
            a.download = `contract_analysis_${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);

            showNotification('ส่งออกข้อมูลเรียบร้อย!');
        }

        function resetScanner() {
            clearFile();
            document.getElementById('analysisSection').style.display = 'none';
            analysisResults = null;
            showNotification('รีเซ็ตระบบสแกนเรียบร้อย');
        }

        // Notification Function
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type === 'error' ? 'error' : ''}`;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // Update time
        function updateTime() {
            const now = new Date();
            const timeElement = document.getElementById('currentTime');
            if (timeElement) {
                timeElement.textContent = now.toLocaleTimeString('th-TH');
            }
        }

        // Initialize when page loads
        window.addEventListener('load', function() {
            initMatrix();
            setupFileUpload();
            updateTime();
            setInterval(updateTime, 1000);
        });

        window.addEventListener('resize', resizeMatrix);
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9832f05ad06bd846',t:'MTc1ODU1NjAyNi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
